<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>第 2 章 Vegan 使用技巧 | 数据科学学习笔记</title>
<meta name="author" content="高春辉">
<meta name="description" content="R package for community ecologists: popular ordination methods, ecological null models &amp; diversity analysis Vegan 是面向研究群落的生态学家开发的软件包，包括了流行的坐标分析方法、生态学的零假设和多样性分析方法。 library(vegan)  2.1 计算...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="第 2 章 Vegan 使用技巧 | 数据科学学习笔记">
<meta property="og:type" content="book">
<meta property="og:description" content="R package for community ecologists: popular ordination methods, ecological null models &amp; diversity analysis Vegan 是面向研究群落的生态学家开发的软件包，包括了流行的坐标分析方法、生态学的零假设和多样性分析方法。 library(vegan)  2.1 计算...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第 2 章 Vegan 使用技巧 | 数据科学学习笔记">
<meta name="twitter:description" content="R package for community ecologists: popular ordination methods, ecological null models &amp; diversity analysis Vegan 是面向研究群落的生态学家开发的软件包，包括了流行的坐标分析方法、生态学的零假设和多样性分析方法。 library(vegan)  2.1 计算...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">数据科学学习笔记</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">前言</a></li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">1</span> R Markdown</a></li>
<li class="book-part">微生物生态学</li>
<li><a class="active" href="using-vegan.html"><span class="header-section-number">2</span> Vegan 使用技巧</a></li>
<li><a class="" href="probability-statistics.html"><span class="header-section-number">3</span> 概率论和数理统计</a></li>
<li class="book-part">数据挖掘实战</li>
<li><a class="" href="data-mining-practise.html"><span class="header-section-number">4</span> 关于《数据挖掘实战》</a></li>
<li><a class="" href="association-analysis.html"><span class="header-section-number">5</span> 关联规则挖掘</a></li>
<li><a class="" href="clustering-analysis.html"><span class="header-section-number">6</span> 聚类分析</a></li>
<li><a class="" href="linear-model.html"><span class="header-section-number">7</span> 线性模型和广义线性模型</a></li>
<li><a class="" href="neural-network.html"><span class="header-section-number">8</span> 神经网络</a></li>
<li><a class="" href="decision-tree.html"><span class="header-section-number">9</span> 决策树</a></li>
<li class="book-part">Others</li>
<li><a class="" href="officer.html"><span class="header-section-number">10</span> 处理 Office 文件</a></li>
<li><a class="" href="ggtree-as-phylo-hclust2.html"><span class="header-section-number">11</span> ggtree 代码解析</a></li>
<li><a class="" href="references.html">参考文献</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="using-vegan" class="section level1" number="2">
<h1>
<span class="header-section-number">第 2 章</span> Vegan 使用技巧<a class="anchor" aria-label="anchor" href="#using-vegan"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>R package for community ecologists: popular ordination methods, ecological null models &amp; diversity analysis</p>
</blockquote>
<p><strong>Vegan</strong> 是面向研究群落的生态学家开发的软件包，包括了流行的坐标分析方法、生态学的零假设和多样性分析方法。</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span></span></code></pre></div>
<div id="计算-beta-dispersion" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> 计算 beta-dispersion<a class="anchor" aria-label="anchor" href="#%E8%AE%A1%E7%AE%97-beta-dispersion"><i class="fas fa-link"></i></a>
</h2>
<p>使用 <code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code> 计算。这是一个 beta-diversity （β多样性）指标。</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="st">"betadisper"</span><span class="op">)</span></span></code></pre></div>
<div id="使用-varespec-数据集计算-beta-dispersion" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> 使用 <code>varespec</code> 数据集计算 beta-dispersion<a class="anchor" aria-label="anchor" href="#%E4%BD%BF%E7%94%A8-varespec-%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AE%A1%E7%AE%97-beta-dispersion"><i class="fas fa-link"></i></a>
</h3>
<div id="数据集说明" class="section level4" number="2.1.1.1">
<h4>
<span class="header-section-number">2.1.1.1</span> 数据集说明<a class="anchor" aria-label="anchor" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AF%B4%E6%98%8E"><i class="fas fa-link"></i></a>
</h4>
<p><code>varespec</code> 数据有 24 行和 44 列，是 44 个物种（species）在 24 个样品（site）中的估计覆盖率，
列名是 44 个物种拉丁名称的简写。<code>varechem</code> 数据有 24 行、14 列，是 24 个样品
中 14 个土壤相关的属性。</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Bray-Curtis distances between samples</span></span>
<span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="样本间距" class="section level4" number="2.1.1.2">
<h4>
<span class="header-section-number">2.1.1.2</span> 样本间距<a class="anchor" aria-label="anchor" href="#%E6%A0%B7%E6%9C%AC%E9%97%B4%E8%B7%9D"><i class="fas fa-link"></i></a>
</h4>
<p><code>vegdist</code> 默认计算样品间的 Bray-Curtis 距离，其定义为：</p>
<p><span class="math display">\[d_{jk} = (\sum abs(x_{ij}-x_{ik}))/(\sum (x_{ij}+x_{ik}))\]</span></p>
<p>其中，<span class="math inline">\(x_{ij}\)</span> 和 <span class="math inline">\(x_{ik}\)</span> 分别代表物种（列） <span class="math inline">\(i\)</span> 在两个样品（行）<span class="math inline">\(j\)</span> 和 <span class="math inline">\(k\)</span> 中的数量。
则前两个位点的 Bray-Curtis 距离是 0.5310021。</p>
</div>
<div id="样本分组及计算结果" class="section level4" number="2.1.1.3">
<h4>
<span class="header-section-number">2.1.1.3</span> 样本分组及计算结果<a class="anchor" aria-label="anchor" href="#%E6%A0%B7%E6%9C%AC%E5%88%86%E7%BB%84%E5%8F%8A%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## First 16 sites grazed, remaining 8 sites ungrazed</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grazed"</span>,<span class="st">"ungrazed"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate multivariate dispersions</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span><span class="op">)</span></span>
<span><span class="va">mod</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dis, group = groups)
## 
## No. of Positive Eigenvalues: 15
## No. of Negative Eigenvalues: 8
## 
## Average distance to median:
##   grazed ungrazed 
##   0.3926   0.2706 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 23 eigenvalues)
##  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
## 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284</code></pre>
<p><code>mod</code> 返回一个 <em>betadisper</em> 类的列表，有以下几个元件：</p>
<ul>
<li><p><code>eig</code>：numeric；PCoA 分析的特征值</p></li>
<li><p><code>vectors</code>: matrix；PCoA 分析特征向量</p></li>
<li><p><code>distances</code>: numeric；在 PCoA 的多维空间中，每个样本与其对应的分组中心间的欧氏距离。</p></li>
<li><p><code>group</code>: factor；分组信息。</p></li>
<li><p><code>centroids</code>: matrix；分组在 PCoA 坐标系中的中心点。</p></li>
<li><p><code>call</code>: 函数调用信息。</p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<pre><code>## List of 7
##  $ eig            : Named num [1:23] 1.755 1.133 0.443 0.37 0.245 ...
##   ..- attr(*, "names")= chr [1:23] "PCoA1" "PCoA2" "PCoA3" "PCoA4" ...
##  $ vectors        : num [1:24, 1:23] 0.0946 -0.3125 -0.3511 -0.3291 -0.1926 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:24] "18" "15" "24" "27" ...
##   .. ..$ : chr [1:23] "PCoA1" "PCoA2" "PCoA3" "PCoA4" ...
##  $ distances      : Named num [1:24] 0.331 0.245 0.409 0.406 0.271 ...
##   ..- attr(*, "names")= chr [1:24] "18" "15" "24" "27" ...
##  $ group          : Factor w/ 2 levels "grazed","ungrazed": 1 1 1 1 1 1 1 1 1 1 ...
##  $ centroids      : num [1:2, 1:23] -0.1455 0.2786 0.0758 -0.2111 -0.0137 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:2] "grazed" "ungrazed"
##   .. ..$ : chr [1:23] "PCoA1" "PCoA2" "PCoA3" "PCoA4" ...
##  $ group.distances: num [1:2(1d)] 0.393 0.271
##   ..- attr(*, "dimnames")=List of 1
##   .. ..$ : chr [1:2] "grazed" "ungrazed"
##  $ call           : language betadisper(d = dis, group = groups)
##  - attr(*, "class")= chr "betadisper"
##  - attr(*, "method")= chr "bray"
##  - attr(*, "type")= chr "median"
##  - attr(*, "bias.adjust")= logi FALSE</code></pre>
<p>这 24 个样品来自两组处理，其中前 16 个为一组（<strong>grazed</strong>），后 8 个为另一组（<strong>ungrazed</strong>）。
<code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code> 计算了每个组样品距离中心点（“中位数”）距离的平均值。输出中还包括
23 个特征值（<strong>eigenvalues</strong>）。</p>
</div>
<div id="统计分析" class="section level4" number="2.1.1.4">
<h4>
<span class="header-section-number">2.1.1.4</span> 统计分析<a class="anchor" aria-label="anchor" href="#%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90"><i class="fas fa-link"></i></a>
</h4>
<blockquote>
<p>To test <strong>if one or more groups is more variable than the others</strong>, ANOVA of the distances to group centroids can be performed and parametric theory used to interpret the significance of F. An alternative is to use a permutation test. <code>permutest.betadisper</code> permutes model residuals to generate a permutation distribution of F under the Null hypothesis of no difference in dispersion between groups.</p>
</blockquote>
<p><code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> 方法被用来比较各个分组间是否存在有变化程度更大的情况。<code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest()</a></code> 则为这一任务提供了另一种统计分析手段。</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Perform test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Distances
##           Df  Sum Sq  Mean Sq F value  Pr(&gt;F)  
## Groups     1 0.07931 0.079306  4.6156 0.04295 *
## Residuals 22 0.37801 0.017182                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p><code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> 和 <code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest()</a></code> 分别计算显著性。</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Permutation test for F</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod</span>, pairwise <span class="op">=</span> <span class="cn">TRUE</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 99
## 
## Response: Distances
##           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)  
## Groups     1 0.07931 0.079306 4.6156     99   0.04 *
## Residuals 22 0.37801 0.017182                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Pairwise comparisons:
## (Observed p-value below diagonal, permuted p-value above diagonal)
##           grazed ungrazed
## grazed               0.04
## ungrazed 0.04295</code></pre>
<p><code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> 方法则计算出两两 group 之间存在的差异及其显著性。</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Tukey's Honest Significant Differences</span></span>
<span><span class="op">(</span><span class="va">mod.HSD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = distances ~ group, data = df)
## 
## $group
##                       diff        lwr          upr     p adj
## ungrazed-grazed -0.1219422 -0.2396552 -0.004229243 0.0429502</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod.HSD</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></div>
<p><code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> 可以绘制样品和中心点之间的距离。</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot the groups and distances to centroids on the</span></span>
<span><span class="co">## first two PCoA axes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## with data ellipses instead of hulls</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span>, hull <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># 1 sd data ellipse</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-15-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span>, hull <span class="op">=</span> <span class="cn">FALSE</span>, conf <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="co"># 90% data ellipse</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-15-3.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## can also specify which axes to plot, ordering respected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, seg.col <span class="op">=</span> <span class="st">"forestgreen"</span>, seg.lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-15-4.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Draw a boxplot of the distances to centroid for each group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></div>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores()</a></code> 计算样本特征值。</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## `scores` and `eigenvals` also work</span></span>
<span><span class="va">scrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">scrs</span><span class="op">)</span></span></code></pre></div>
<pre><code>## List of 2
##  $ sites    : num [1:24, 1:2] 0.0946 -0.3125 -0.3511 -0.3291 -0.1926 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:24] "18" "15" "24" "27" ...
##   .. ..$ : chr [1:2] "PCoA1" "PCoA2"
##  $ centroids: num [1:2, 1:2] -0.1455 0.2786 0.0758 -0.2111
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:2] "grazed" "ungrazed"
##   .. ..$ : chr [1:2] "PCoA1" "PCoA2"</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 可以将其画在图上</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">scrs</span><span class="op">$</span><span class="va">sites</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.8</span>, <span class="fl">.8</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">scrs</span><span class="op">$</span><span class="va">sites</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">scrs</span><span class="op">$</span><span class="va">sites</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></div>
<ul>
<li>计算给出的样本、样本组的中心点坐标等。</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, display <span class="op">=</span> <span class="st">"sites"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          PCoA1       PCoA2        PCoA3        PCoA4
## 18  0.09459373  0.15914576  0.074400844 -0.202466025
## 15 -0.31248809  0.10032751 -0.062243360  0.110844864
## 24 -0.35106507 -0.05954096 -0.038079447  0.095060928
## 27 -0.32914546 -0.17019348  0.231623720  0.019110623
## 23 -0.19259443 -0.01459250 -0.005679372 -0.209718312
## 19 -0.06794575 -0.14501690 -0.085645653  0.002431355</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># group centroids/medians </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, display <span class="op">=</span> <span class="st">"centroids"</span><span class="op">)</span></span></code></pre></div>
<pre><code>##               PCoA1       PCoA2       PCoA3      PCoA4
## grazed   -0.1455200  0.07584572 -0.01366220 -0.0178990
## ungrazed  0.2786095 -0.21114993 -0.03475586  0.0220129</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># eigenvalues from the underlying principal coordinates analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/eigenvals.html">eigenvals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      PCoA1      PCoA2      PCoA3      PCoA4      PCoA5      PCoA6      PCoA7 
##  1.7552165  1.1334455  0.4429018  0.3698054  0.2453532  0.1960921  0.1751131 
##      PCoA8      PCoA9     PCoA10     PCoA11     PCoA12     PCoA13     PCoA14 
##  0.1284467  0.0971594  0.0759601  0.0637178  0.0583225  0.0394934  0.0172699 
##     PCoA15     PCoA16     PCoA17     PCoA18     PCoA19     PCoA20     PCoA21 
##  0.0051011 -0.0004131 -0.0064654 -0.0133147 -0.0253944 -0.0375105 -0.0480069 
##     PCoA22     PCoA23 
## -0.0537146 -0.0741390</code></pre>
<ul>
<li>
<code>bias.adjust = TRUE</code> 对于 beta-多样性估计中的小样本偏差进行校正。</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## try out bias correction; compare with mod3</span></span>
<span><span class="op">(</span><span class="va">mod3B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span>, type <span class="op">=</span> <span class="st">"median"</span>, bias.adjust<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dis, group = groups, type = "median", bias.adjust
## = TRUE)
## 
## No. of Positive Eigenvalues: 15
## No. of Negative Eigenvalues: 8
## 
## Average distance to median:
##   grazed ungrazed 
##   0.4055   0.2893 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 23 eigenvalues)
##  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
## 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod3B</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Distances
##           Df  Sum Sq  Mean Sq F value  Pr(&gt;F)  
## Groups     1 0.07193 0.071927  3.7826 0.06468 .
## Residuals 22 0.41834 0.019015                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod3B</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 99
## 
## Response: Distances
##           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)  
## Groups     1 0.07193 0.071927 3.7826     99   0.08 .
## Residuals 22 0.41834 0.019015                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<ul>
<li>哪怕只有一个分组，仍然可以使用</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## should always work for a single group</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"grazed"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">group</span>, type <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dis, group = group, type = "median")
## 
## No. of Positive Eigenvalues: 15
## No. of Negative Eigenvalues: 8
## 
## Average distance to median:
## grazed 
## 0.4255 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 23 eigenvalues)
##  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
## 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">group</span>, type <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dis, group = group, type = "centroid")
## 
## No. of Positive Eigenvalues: 15
## No. of Negative Eigenvalues: 8
## 
## Average distance to centroid:
## grazed 
## 0.4261 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 23 eigenvalues)
##  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
## 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284</code></pre>
<ul>
<li>当有缺失值的时候，也可以使用</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## simulate missing values in 'd' and 'group'</span></span>
<span><span class="co">## using spatial medians</span></span>
<span><span class="va">groups</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">dis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span><span class="op">)</span> <span class="co">## messages</span></span>
<span><span class="va">mod2</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dis, group = groups)
## 
## No. of Positive Eigenvalues: 14
## No. of Negative Eigenvalues: 5
## 
## Average distance to median:
##   grazed ungrazed 
##   0.3984   0.3008 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 19 eigenvalues)
##  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
## 1.4755 0.8245 0.4218 0.3456 0.2159 0.1688 0.1150 0.1060</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod2</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 99
## 
## Response: Distances
##           Df   Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.039979 0.039979 2.4237     99   0.11
## Residuals 18 0.296910 0.016495</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Distances
##           Df   Sum Sq  Mean Sq F value Pr(&gt;F)
## Groups     1 0.039979 0.039979  2.4237 0.1369
## Residuals 18 0.296910 0.016495</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-21-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-21-3.png" width="672" style="display: block; margin: auto;"></div>
<ul>
<li>
<code>type = "centroid"</code> 时的结果（默认为 <code>type = "median"</code>，一般不需要修改）。</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using group centroids</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span>, type <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span></span>
<span><span class="va">mod3</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dis, group = groups, type = "centroid")
## 
## No. of Positive Eigenvalues: 14
## No. of Negative Eigenvalues: 5
## 
## Average distance to centroid:
##   grazed ungrazed 
##   0.4001   0.3108 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 19 eigenvalues)
##  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
## 1.4755 0.8245 0.4218 0.3456 0.2159 0.1688 0.1150 0.1060</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod3</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 99
## 
## Response: Distances
##           Df   Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
## Groups     1 0.033468 0.033468 3.1749     99    0.1
## Residuals 18 0.189749 0.010542</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Distances
##           Df   Sum Sq  Mean Sq F value  Pr(&gt;F)  
## Groups     1 0.033468 0.033468  3.1749 0.09166 .
## Residuals 18 0.189749 0.010542                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-22-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-22-3.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="使用-dune-数据集计算-beta-dispersion" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> 使用 <code>dune</code> 数据集计算 beta-dispersion<a class="anchor" aria-label="anchor" href="#%E4%BD%BF%E7%94%A8-dune-%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AE%A1%E7%AE%97-beta-dispersion"><i class="fas fa-link"></i></a>
</h3>
<blockquote>
<p>本例子来源于 Vignettes: Diversity analysis in vegan.</p>
</blockquote>
<p>使用的数据是荷兰沙丘（dune）草地牧场（meadow）上的植被（vegetation）和环境因子。</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vegetation and Environment in Dutch Dune Meadows.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"dune"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"dune.env"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>使用 <code><a href="https://rdrr.io/pkg/vegan/man/betadiver.html">betadiver()</a></code> 计算 beta-多样性。</li>
</ul>
<p><code><a href="https://rdrr.io/pkg/vegan/man/betadiver.html">betadiver()</a></code> 的第二个参数指定计算 beta 多样性指标的算法。算法基于 <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span> 等 3 个值（使用 <code>betadiver(help = TRUE)</code> 查看计算公式）。它们的含义如下：</p>

<p><code>method = "z"</code> 时，计算的公式为：</p>
<p><span class="math display">\[z = (log(2) - log(2*a+b+c) + log(a+b+c))/log(2)\]</span></p>
<p>计算得到的 <code>z</code> 是一个 <em>dist</em> 对象。</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadiver.html">betadiver</a></span><span class="op">(</span><span class="va">dune</span>, method <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span></span>
<span><span class="va">z</span></span></code></pre></div>
<pre><code>##            1         2         3         4         5         6         7
## 2  0.4150375                                                            
##            8         9        10        11        12        13        14
## 2                                                                       
##           15        16        17        18        19
## 2                                                   
##  [ reached getOption("max.print") -- omitted 18 rows ]</code></pre>
<p>按照 <code>dune.env$Management</code> 中给出的土地管理类型进行分组，计算 beta-dispersion。</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">z</span>, <span class="va">Management</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = z, group = Management)
## 
## No. of Positive Eigenvalues: 12
## No. of Negative Eigenvalues: 7
## 
## Average distance to median:
##     BF     HF     NM     SF 
## 0.2532 0.2512 0.4406 0.3635 
## 
## Eigenvalues for PCoA axes:
## (Showing 8 of 19 eigenvalues)
##   PCoA1   PCoA2   PCoA3   PCoA4   PCoA5   PCoA6   PCoA7   PCoA8 
## 1.65466 0.88696 0.53336 0.37435 0.28725 0.22445 0.16128 0.08099</code></pre>
<p>对计算得到的结果进行可视化。</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="leaning-note_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="rmarkdown.html"><span class="header-section-number">1</span> R Markdown</a></div>
<div class="next"><a href="probability-statistics.html"><span class="header-section-number">3</span> 概率论和数理统计</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#using-vegan"><span class="header-section-number">2</span> Vegan 使用技巧</a></li>
<li>
<a class="nav-link" href="#%E8%AE%A1%E7%AE%97-beta-dispersion"><span class="header-section-number">2.1</span> 计算 beta-dispersion</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-varespec-%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AE%A1%E7%AE%97-beta-dispersion"><span class="header-section-number">2.1.1</span> 使用 varespec 数据集计算 beta-dispersion</a></li>
<li><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-dune-%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AE%A1%E7%AE%97-beta-dispersion"><span class="header-section-number">2.1.2</span> 使用 dune 数据集计算 beta-dispersion</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>数据科学学习笔记</strong>" was written by 高春辉. It was last built on 2022-07-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
